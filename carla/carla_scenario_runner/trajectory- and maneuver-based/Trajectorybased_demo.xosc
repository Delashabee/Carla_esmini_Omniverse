<?xml version="1.0" encoding="UTF-8"?>
<OpenSCENARIO>
  <FileHeader revMajor="1" revMinor="0"
              date="2025-07-10"
              description="Trajectory-based scenario demo"
              author="generated"/>
    <CatalogLocations/>

    <RoadNetwork>
        <LogicFile filepath="Town10HD"/>
        <SceneGraphFile filepath=""/>
    </RoadNetwork>

    <Entities>
        <ScenarioObject name="Ego">
            <Vehicle name="vehicle.tesla.model3" vehicleCategory="car">
                <BoundingBox>
                    <Center x="1.5" y="0.0" z="0.9"/>
                    <Dimensions width="2.0" length="4.5" height="1.8"/>
                </BoundingBox>
                <Performance maxSpeed="50" maxAcceleration="8" maxDeceleration="8"/>
                <Axles>
                    <FrontAxle maxSteering="0.5" wheelDiameter="0.6" trackWidth="1.8" positionX="3.1" positionZ="0.3"/>
                    <RearAxle maxSteering="0.0" wheelDiameter="0.6" trackWidth="1.8" positionX="0.0" positionZ="0.3"/>
                </Axles>
                <Properties>
                    <Property name="type" value="ego_vehicle"/>
                </Properties>
           </Vehicle>
        </ScenarioObject>
    </Entities>

    <Storyboard>
        <Init>
            <Actions>
                <Private entityRef="Ego">
                    <PrivateAction>
                        <TeleportAction>
                            <Position>
                                <WorldPosition x="15" y="15" z="1" h="135" p="0" r="0"/>
                            </Position>
                        </TeleportAction>
                    </PrivateAction>
                </Private>
            </Actions>
        </Init>

        <Story name="TrajectoryStory">
            <Act name="TrajectoryAct">
                <ManeuverGroup maximumExecutionCount="1" name="TrajectorySequence">
                    <Actors selectTriggeringEntities="false">
                        <EntityRef entityRef="Ego"/>
                    </Actors>

                    <Maneuver name="ForwardStopLeftForward">
                        <Event name="Forward5m" priority="overwrite">
                            <Action name="Forward5mAction">
                                <PrivateAction>
                                    <RoutingAction>
                                        <FollowTrajectoryAction>
                                            <Trajectory name="Forward5mTraj" closed="false">
                                                <Shape>
                                                    <Polyline>
                                                        <Vertex time="0">
                                                            <Position>
                                                                <WorldPosition x="15" y="15" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                        <Vertex time="5">
                                                            <Position>
                                                                <WorldPosition x="11.46" y="18.53" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                    </Polyline>
                                                </Shape>
                                            </Trajectory>
                                            <TimeReference>
                                                <Timing domainAbsoluteRelative="absolute" scale="1.0" offset="0"/>
                                            </TimeReference>
                                            <TrajectoryFollowingMode followingMode="position"/>                                            
                                        </FollowTrajectoryAction>
                                    </RoutingAction>
                                </PrivateAction>
                            </Action>
                            <StartTrigger>
                                <ConditionGroup>
                                    <Condition name="start" delay="0" conditionEdge="rising">
                                        <ByValueCondition>
                                            <SimulationTimeCondition value="0" rule="greaterThan"/>
                                        </ByValueCondition>
                                    </Condition>
                                </ConditionGroup>
                            </StartTrigger>
                        </Event>

                        <Event name="Left1m" priority="overwrite">
                            <Action name="Left1mAction">
                                <PrivateAction>
                                    <RoutingAction>
                                        <FollowTrajectoryAction>
                                            <Trajectory name="Left1mTraj" closed="false">
                                                <Shape>
                                                    <Polyline>
                                                        <Vertex time="5">
                                                            <Position>
                                                                <WorldPosition x="11.46" y="18.53" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                        <Vertex time="7">
                                                            <Position>
                                                                <WorldPosition x="10.7574" y="17.8284" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                    </Polyline>
                                                </Shape>
                                            </Trajectory>
                                            <TimeReference>
                                                <Timing domainAbsoluteRelative="absolute" scale="1.0" offset="0"/>
                                            </TimeReference>
                                            <TrajectoryFollowingMode followingMode="position"/>
                                        </FollowTrajectoryAction>
                                    </RoutingAction>
                                </PrivateAction>
                            </Action>
                            <StartTrigger>
                                <ConditionGroup>
                                    <Condition name="afterForward" delay="0" conditionEdge="rising">
                                        <ByEntityCondition>
                                            <TriggeringEntities triggeringEntitiesRule="any">
                                                <EntityRef entityRef="Ego"/>
                                            </TriggeringEntities>
                                            <EntityCondition>
                                                <ReachPositionCondition tolerance="0.1">
                                                    <Position>
                                                        <WorldPosition x="11.46" y="18.53" z="0"/>
                                                    </Position>
                                                </ReachPositionCondition>
                                            </EntityCondition>
                                        </ByEntityCondition>
                                    </Condition>
                                </ConditionGroup>
                            </StartTrigger>
                        </Event>

                        <Event name="Forward5mAgain" priority="overwrite">
                            <Action name="Forward5mAgainAction">
                                <PrivateAction>
                                    <RoutingAction>
                                        <FollowTrajectoryAction>
                                            <Trajectory name="Forward5mAgainTraj" closed="false">
                                                <Shape>
                                                    <Polyline>
                                                        <Vertex time="7">
                                                            <Position>
                                                                <WorldPosition x="10.7574" y="17.8284" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                        <Vertex time="12">
                                                            <Position>
                                                                <WorldPosition x="7.2219" y="21.3639" z="0"/>
                                                            </Position>
                                                        </Vertex>
                                                    </Polyline>
                                                </Shape>
                                            </Trajectory>
                                            <TimeReference>
                                                <Timing domainAbsoluteRelative="absolute" scale="1.0" offset="0"/>
                                            </TimeReference>
                                            <TrajectoryFollowingMode followingMode="position"/>                                            
                                        </FollowTrajectoryAction>
                                    </RoutingAction>
                                </PrivateAction>
                            </Action>
                            <StartTrigger>
                                <ConditionGroup>
                                    <Condition name="afterLeft" delay="0" conditionEdge="rising">
                                        <ByEntityCondition>
                                            <TriggeringEntities triggeringEntitiesRule="any">
                                                <EntityRef entityRef="Ego"/>
                                            </TriggeringEntities>
                                            <EntityCondition>
                                                <ReachPositionCondition tolerance="0.1">
                                                    <Position>
                                                        <WorldPosition x="10.7574" y="17.8284" z="0"/>
                                                    </Position>
                                                </ReachPositionCondition>
                                            </EntityCondition>
                                        </ByEntityCondition>
                                    </Condition>
                                </ConditionGroup>
                            </StartTrigger>
                        </Event>
                    </Maneuver>
                </ManeuverGroup>

                <StartTrigger>
                    <ConditionGroup>
                        <Condition name="ActStartCondition" delay="0" conditionEdge="rising">
                            <ByValueCondition>
                                <SimulationTimeCondition value="0" rule="greaterThan"/>
                            </ByValueCondition>
                        </Condition>
                    </ConditionGroup>
                </StartTrigger>
            </Act>
        </Story>

        <StopTrigger>
            <ConditionGroup>
                <Condition name="endCondition" delay="0" conditionEdge="rising">
                    <ByEntityCondition>
                        <TriggeringEntities triggeringEntitiesRule="any">
                            <EntityRef entityRef="Ego"/>
                        </TriggeringEntities>
                        <EntityCondition>
                            <ReachPositionCondition tolerance="0.1">
                                <Position>
                                    <WorldPosition x="7.2219" y="21.3639" z="0"/>
                                </Position>
                            </ReachPositionCondition>
                        </EntityCondition>
                    </ByEntityCondition>
                </Condition>
            </ConditionGroup>
        </StopTrigger>
    </Storyboard>
</OpenSCENARIO>
